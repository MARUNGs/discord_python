# ì›¹ í›„í¬ë¥¼ ì´ìš©í•œ ë””ìŠ¤ì½”ë“œ ë´‡ ë°˜ë³µë©”ì„¸ì§€ ë³´ë‚´ê¸° #

# ë°˜ë³µ ì‘ì—…ì„ ìœ„í•œ íŒ¨í‚¤ì§€
from discord.ext import tasks
# í˜„ì¬ ì‹œê°„ì„ ë°›ì•„ì™€ êµ¬ì¡°ì²´ì— ë„£ì–´ì£¼ëŠ” ìš©ë„ë¡œ ì‚¬ìš©í•  íŒ¨í‚¤ì§€
import datetime
# ì¤‘ë³µ ì „ì†¡ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•  íŒ¨í‚¤ì§€
import time
import requests
import asyncio

# í˜„ì¬ ì‹œê°„
now_dt = datetime.datetime.now()
year = now_dt.year

discord_url = "ì›¹í›„í¬URL"


# ë””ìŠ¤ì½”ë“œ ì±„ë„ë¡œ ë©”ì„¸ì§€ ì „ì†¡ #
def discord_send_msg(text):
  now = datetime.datetime.now()
  msg = {"content": f"[{now.strftime('%Y-%m-%d %H:%M:%S')}] {str(text)}"}
  requests.post(discord_url, data = msg)

# ì´ê±´ í…ŒìŠ¤íŠ¸ ëë‚˜ì„œ ë”ì´ìƒ ì‚¬ìš© ì•ˆí•¨ ã…‹ã…‹ 
# discord_send_msg("ê°œí–‰ë¬¸ì í…ŒìŠ¤íŠ¸")



# ##################################################################################################
# ë³¸ê²©ì ìœ¼ë¡œ ë§Œë“œëŠ” í•˜ë£¨í•œë²ˆ ë°˜ë³µë©”ì„¸ì§€ ë³´ë‚´ê¸° #
@tasks.loop(seconds=1)
async def everyday_23_01_notice():
  hour   = datetime.datetime.now().hour
  minute = datetime.datetime.now().minute
  second = datetime.datetime.now().second

  # ì˜¤í›„ 23ì‹œ 01ë¶„ë§ˆë‹¤ ìˆ˜í–‰ START #
  # if (hour == 23) and (minute == 1) and (second > 0):
  if (hour == 16) and (minute == 3) and (second > 0):
    # ë””ìŠ¤ì½”ë“œ ë´‡ì—ê²Œ ì „ë‹¬
    discord_send_msg(f"ë‚´ì¼ ê°€ëŠ¥í•˜ì‹  ë¶„ ì†~ ğŸ™‹ğŸ»â€â™€ï¸ğŸ™‹ğŸ»â€â™‚ï¸ğŸ™‹ğŸ»")
    
    # 1ì´ˆ sleepí•˜ì—¬ ì¤‘ë³µ ì „ì†¡ ë°©ì§€
    await time.sleep(1)
    # ì¢…ë£Œ
    everyday_23_01_notice.stop()
  else:
    now = datetime.datetime.now()
    print(f"í˜„ì¬ì‹œê°: [{now.strftime('%Y-%m-%d %H:%M:%S')}] ì…ë‹ˆë‹¤...")
# ì˜¤í›„ 23ì‹œ 01ë¶„ë§ˆë‹¤ ìˆ˜í–‰ END #

# main() START #
async def main():
  # ì‹œì‘
  everyday_23_01_notice.start()

  while True:
    await asyncio.sleep(1)
# main() END #


if __name__ == '__main__':
  try:
    asyncio.run(main())
  except RuntimeError as E:
    print(f"ì—ëŸ¬ ë°œê²¬! {E}")
